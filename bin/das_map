#!/bin/bash

if  [ $# != 1 ]; then
   echo "Usage: das_map <location of the map directory>"
   exit 1
fi
dir=$1
echo "Read DAS maps from $dir"
cmd=$DAS_ROOT/src/python/DAS/tools/das_mapping_db.py

# run actual script
echo "Clean DAS Mapping DB"
$cmd --clean

echo "Add API maps"
for amap in `ls $dir/*.yml`
do
    service=`echo $amap | awk '{z=split($0,a,"/"); split(a[z],b,"."); print b[1]}'`
    echo "Read API maps from $amap"
    $cmd --uri-map=$amap
    echo "Read notation map from $amap"
    $cmd --notation-map=$amap
    echo "Read presentation map from $amap"
    $cmd --presentation-map=$amap
done
