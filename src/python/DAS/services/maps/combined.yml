# Combined API Mapping to DAS
system : combined
format : JSON
services : {
    "dbs": "http://cmsdbsprod.cern.ch/cms_dbs_prod_global/servlet/DBSServlet",
    "dbs3": "https://cmsweb.cern.ch/dbs/prod/global/DBSReader",
    "phedex": "https://cmsweb.cern.ch/phedex/datasvc/json/prod",
    "conddb": "https://cms-conddb.cern.ch",
}
---
urn : combined_dataset4site_release
url : "http://localhost:8212/dbs_phedex"
expire : 3600
params : {"release":"required", "site":"required"}
lookup : dataset
das_map : [
    {"das_key":"dataset", "rec_key":"dataset.name"},
    {"das_key":"release", "rec_key":"release.name", "api_arg":"release"},
    {"das_key":"site", "rec_key":"site.name", "api_arg":"site", "pattern":"^T[0-3]_"},
    {"das_key":"site", "rec_key":"site.se", "api_arg":"site", "pattern":"([a-zA-Z0-9-_]+\\.){2}"},
]
---
urn : combined_dataset4site
url : "http://localhost:8212/dbs_phedex/dataset"
expire : 3600
params : {"site":"required"}
lookup : dataset
das_map : [
    {"das_key":"dataset", "rec_key":"dataset.name"},
    {"das_key":"site", "rec_key":"site.name", "api_arg":"site", "pattern":"^T[0-3]_"},
    {"das_key":"site", "rec_key":"site.se", "api_arg":"site", "pattern":"([a-zA-Z0-9-_]+\\.){2}"},
]
---
urn : combined_site4dataset
url : "http://localhost:8212/dbs_phedex"
expire : 3600
params : {"dataset":"required"}
lookup : site
das_map : [
    {"das_key":"site", "rec_key":"site.name", "pattern":"^T[0-3]_"},
    {"das_key":"dataset", "rec_key":"dataset.name", "api_arg":"dataset"},
]
---
urn : combined_lumi4dataset
url : "http://localhost:8212/dbs_lumi/lumi"
format : JSON
expire : 3600
params : {"dataset":"required"}
lookup : lumi
das_map : [
    {"das_key":"lumi", "rec_key":"lumi.runlumis"},
    {"das_key":"dataset", "rec_key":"dataset.name", "api_arg":"dataset"},
]
