# SiteDB API mapping to DAS
system: new_sitedb
format: JSON
#---
# NOT READY
#urn : status
#url : "http://localhost:8010/sites/status"
#expire : 3600
#params : 
#    name : 'T%'
#daskeys :
#    - key :
#      map :
#      pattern : ''
#api2das :
#    - api_param : name
#      das_key : site
#      pattern : "re.compile('^T[0-3]')"
##### This was commented out
#        - api_param : name
#          das_key : site
#          pattern : "re.compile('([a-zA-Z0-9]+\\.){2}')"
--- 
urn : resource_element
url : "http://localhost:8010/sites/resource_element"
expire : 3600
params : 
    name : 'T%'
    type : '%'
daskeys :
    - key : site
      map : site.name
      pattern : "re.compile('^T[0-3]')"
#    - key : site
#      map : site.resource_element.fqdn
#      pattern : "re.compile('([a-zA-Z0-9]+\\.){2}')"
api2das :
    - api_param : name
      das_key : site
      pattern : "re.compile('^T[0-3]')"
    - api_param : type
      das_key : site.type
      pattern : ''
--- 
urn : resource_pledge
url : "http://localhost:8010/sites/resource_pledge"
expire : 3600
params : 
    name : 'T%'
#    quarter : '%'
daskeys :
    - key : site
      map : site.name
      pattern : "re.compile('^T[0-3]')"
api2das :
    - api_param : name
      das_key : site
      pattern : "re.compile('^T[0-3]')"
#---
# NOT READY
#urn : names
#url : "http://localhost:8010/sites/names"
#expire : 3600
#params : 
#    name : 'T%'
#    scheme : cms_name
#record :
#    daskeys :
#        - key :
#          map :
#          pattern : ''
#    api2das :
#        - api_param : name
#          das_key : site
#          pattern : "re.compile('^T[0-3]')"
---
urn : links
url : "http://localhost:8010/sites/links"
expire : 3600
params : 
    name : 'T%'
daskeys :
    - key : url
      map : site.url
      pattern : ''
api2das :
    - api_param : name
      das_key : site
      pattern : "re.compile('^T[0-3]')"
#---
#NOT READY
#urn : groups
#url : "http://localhost:8010/sites/groups"
#expire : 3600
#params : 
#    name : 'T%'
#record :
#    daskeys :
#        - key :
#          map :
#          pattern : ''
#    api2das :
#        - api_param : name
#          das_key : site
#          pattern : "re.compile('^T[0-3]')"
---
urn : contacts
url : "http://localhost:8010/sites/contacts"
expire : 3600
params : 
    name : 'T%'
#    role : '%'
daskeys :
    - key : admin
      map : site.email
      pattern : 're.compile("[A-Z0-9._%-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}", re.IGNORECASE)'
    - key : role
      map : site.role
      pattern : ''
    - key : phone
      map : site.phone
      pattern : ''
    - key : surname
      map : site.surname
      pattern : ''
    - key : site
      map : site.name
      pattern : "re.compile('^T[0-3]')"
api2das :
    - api_param : name
      das_key : site
      pattern : "re.compile('^T[0-3]')"
#---
# NOT READY
#urn : pledge_history
#url : "http://localhost:8010/sites/pledge_history"
#expire : 3600
#params : 
#    name : 'T%'
#record :
#    daskeys :
#        - key :
#          map :
#          pattern :
#    api2das :
#        - api_param : name
#          das_key : site
#          pattern : "re.compile('^T[0-3]')"
---
# list API provides information about given name, e.g. T1_CH
# output includes site_name, url, country, usage, cms_name
urn : list
url : "http://localhost:8010/sites/list"
expire : 3600
params : 
    name : 'T%'
    scheme : cms_name
daskeys :
    - key : country
      map : site.country
      pattern : ''
    - key : site
      map : site.name
      pattern : "re.compile('^T[0-3]')"
    - key : url
      map : site.url
      pattern : ''
api2das :
    - api_param : name
      das_key : site
      pattern : "re.compile('^T[0-3]')"
#---
#urn : software
#url : "http://localhost:8010/sites/software"
#expire : 3600
#params : 
#    name : 'T%'
#daskeys :
#    - key :
#      map :
#      pattern :
#api2das :
#    - api_param : name
#      das_key : site
#      pattern : "re.compile('^T[0-3]')"
